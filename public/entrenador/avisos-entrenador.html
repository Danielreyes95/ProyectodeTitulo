<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Avisos - Entrenador</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- CSS Global -->
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/responsive.css">
</head>

<body class="bg-gray-100">

<!-- VALIDACIÓN -->
<script>
if (!localStorage.getItem("token") || localStorage.getItem("rol") !== "entrenador") {
    window.location.href = "../index.html";
}
</script>

<!-- SIDEBAR DINÁMICO -->
<div id="sidebarContainer"></div>
<script src="../js/loadSidebar.js"></script>
<!-- ================================
     CONTENIDO PRINCIPAL
================================ -->
<main class="p-4 sm:p-8 md:ml-60 max-w-6xl mx-auto">

    <!-- HEADER -->
    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8">
        <h1 class="text-2xl sm:text-3xl font-bold text-green-700">
            Avisos a Apoderados
        </h1>

        <button onclick="abrirModalAviso()"
            class="btn bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto">
            + Nuevo aviso
        </button>
    </div>

    <!-- ================================
         LISTADO
    ================================ -->
    <div class="card">

        <div class="responsive-table">
            <table class="table min-w-[650px]">
                <thead>
                    <tr>
                        <th>Título</th>
                        <th>Fecha</th>
                        <th>Destinatario</th>
                        <th class="text-center">Acciones</th>
                    </tr>
                </thead>
                <tbody id="tbodyAvisos"></tbody>
            </table>
        </div>

        <p id="mensajeSinAvisos"
            class="text-center text-gray-500 mt-4 hidden">
            No has enviado avisos aún.
        </p>

    </div>

</main>

<!-- ==================================================
     MODAL CREAR / EDITAR AVISO
=================================================== -->
<div id="modalAviso"
     class="modal hidden">

    <div class="modal-content w-[90%] max-w-[500px]">

        <h2 id="tituloModalAviso"
            class="text-xl font-bold text-green-700 mb-4">
            Nuevo aviso
        </h2>

        <!-- TITULO -->
        <div class="mb-3">
            <label class="font-semibold">Título</label>
            <input type="text" id="avisoTitulo" class="input">
        </div>

        <!-- CONTENIDO -->
        <div class="mb-3">
            <label class="font-semibold">Contenido</label>
            <textarea id="avisoContenido" class="input" rows="4"></textarea>
        </div>

        <!-- DESTINATARIO -->
        <div class="mb-3">
            <label class="font-semibold">Destinatario</label>
            <select id="avisoDestinatario" class="input" onchange="mostrarJugador()">
                <option value="Categoria">Todos los apoderados de mi categoría</option>
                <option value="Jugador">Apoderado de jugador específico</option>
            </select>
        </div>

        <!-- SELECCIÓN DE JUGADOR -->
        <div id="bloqueJugador" class="mb-3 hidden">
            <label class="font-semibold">Jugador</label>
            <select id="avisoJugadorId" class="input"></select>
        </div>

        <!-- BOTONES -->
        <div class="flex justify-end gap-3 mt-5">

            <button onclick="cerrarModalAviso()"
                class="btn bg-gray-300 hover:bg-gray-400">
                Cancelar
            </button>

            <button onclick="guardarAviso()"
                class="btn bg-green-600 hover:bg-green-700 text-white">
                Enviar aviso
            </button>

        </div>

    </div>
</div>

<!-- SOCKET.IO -->
<script src="/socket.io/socket.io.js"></script>

<!-- LÓGICA -->
<script src="/js/avisos-entrenador.js"></script>

</body>
</html>
