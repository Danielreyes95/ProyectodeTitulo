<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Reportes - Entrenador</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

<!-- VALIDACIÓN -->
<script>
if (!localStorage.getItem("token") || localStorage.getItem("rol") !== "entrenador") {
    window.location.href = "../index.html";
}
</script>

<div class="flex">

    <!-- SIDEBAR -->
    <aside class="w-60 bg-green-700 text-white min-h-screen p-4 flex flex-col gap-4 shadow-lg">
        <h2 class="text-xl font-bold mb-5 text-center">Entrenador</h2>

        <a href="./entrenador.html" class="hover:underline">Inicio</a>
        <a href="./miCategoria.html" class="hover:underline">Mi Categoría</a>
        <a href="./asistencia-jugadores.html" class="hover:underline">Asistencia</a>
        <a href="./rendimiento.html" class="hover:underline">Rendimiento</a>
        <a href="./eventos.html" class="hover:underline">Eventos</a>
        <a href="./avisos-entrenador.html" class="hover:underline">Avisos</a>
        <a href="./reportes-entrenador.html" class="font-bold underline">Reportes</a>

        <button onclick="logout()" class="bg-red-600 p-2 mt-auto rounded hover:bg-red-700">
            Cerrar sesión
        </button>
    </aside>

    <!-- CONTENIDO PRINCIPAL -->
    <main class="flex-1 p-8">

        <h1 class="text-3xl font-bold text-green-700 mb-6">Reportes de mi Categoría</h1>

        <div class="border border-gray-300 rounded-lg p-6 bg-white shadow-md">

            <h2 class="text-xl font-bold text-green-800 mb-4">Gráficos y Reportes Detallados</h2>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">

                <div>
                    <label class="font-semibold">Tipo de reporte</label>
                    <select id="tipoReporte" class="w-full border p-2 rounded">
                        <option value="">Seleccione…</option>
                        <option value="jugadores">Listado jugadores + apoderado</option>
                        <option value="asistencia">Asistencia por jugador</option>
                        <option value="rendimiento">Rendimiento por jugador</option>
                    </select>
                </div>

                <div>
                    <label class="font-semibold">Mes</label>
                    <select id="reporteMes" class="w-full border p-2 rounded">
                        <option value="">—</option>
                        <script>
                            const mesesE = ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
                            document.write(mesesE.map((m,i)=>`<option value="${i+1}">${m}</option>`).join(""));
                        </script>
                    </select>
                </div>

                <div>
                    <label class="font-semibold">Año</label>
                    <select id="reporteAnyo" class="w-full border p-2 rounded">
                        <option value="">—</option>
                        <script>
                            const yearE = new Date().getFullYear();
                            for(let y = yearE; y >= yearE-5; y--){
                                document.write(`<option value="${y}">${y}</option>`);
                            }
                        </script>
                    </select>
                </div>

                <div>
                    <label class="font-semibold">Categoría</label>
                    <!-- Se rellena con la categoría del entrenador y se deshabilita -->
                    <select id="reporteCategoria" class="w-full border p-2 rounded bg-gray-100" disabled></select>
                </div>
            </div>

            <button onclick="generarReporte()" class="bg-green-700 hover:bg-green-800 text-white px-4 py-2 rounded shadow">
                Generar Reporte
            </button>

            <div id="contenedorReporte" class="mt-8 min-h-[300px] p-4 border rounded bg-gray-50 shadow-inner">
                <p class="text-gray-500">Aquí aparecerán los gráficos o tablas del reporte seleccionado.</p>
            </div>

            <button onclick="descargarPDF()" class="mt-6 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded shadow">
                Descargar PDF
            </button>

        </div>

    </main>
</div>

<!-- Librerías para PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script src="/js/config.js"></script>
<script src="/js/reportes-entrenador.js" defer></script>

<script>
function logout() {
    localStorage.clear();
    window.location.href = "../index.html";
}
</script>

</body>
</html>
